第4章 基于概率论的分类方法：朴素贝叶斯（NB）
==========================================
前两章要求分类器给出明确的答案，但分类器有时会产生错误结果，这时可以要求分类器给出一个最优的类别猜测结果，同时给出这个猜测的概率估计值。

第3章在计算特征值取某个值的概率时涉及了一些概率知识，在那里我们先统计特征在数据集中取某个特征值的次数，然后除以数据集的实例总数，就得到了特征取该值的概率。

本章会给出一些使用概率论进行分类的方法--朴素贝叶斯分类器

**优点**：在数据较少的情况下仍然有效，可以处理多类别问题。

**缺点**：对于输入数据的准备方式比较敏感。

**适用数据范围**：标称型数据。

# 1 基于贝叶斯决策理论的分类方法
 
贝叶斯决策理论的**核心思想**：选择具有最高概率的决策。

我们用p1(x, y) 表示数据点(x, y)属于类别1的概率，p2(x, y) 表示数据点(x, y)属于类别2的概率,那么对于一个新数据点(x, y),可以用下面的规则判断它的类别：

- 如果p1(x, y) > p2(x, y) , 那么类别为1。
- 如果p2(x, y) > p1(x, y) , 那么类别为2.

**注: 贝叶斯概率引入先验知识和逻辑推理来处理不确定命题。另一种概率解释称为频数概率(frequency probability)只是从数据本身获得结论，并不考虑逻辑推理及先验知识。**

# 2 条件概率

假设一个桶里装有7块石头，其中3块灰色，4块黑色。如果从桶里随机取出一块石头，那么是灰色的可能性是多少？

	由于取石头有7种可能，其中3种是灰色，所以取出灰色石头的概率是3/7

如果7块石头是放在两个桶里，A桶2灰2黑、B桶1灰2黑.条件概率(conditional probability) ,计算从B桶中取到灰色石头的概率，记为P(灰|B),称为“在已经石头出处B桶的条件下，取出灰色石头的概率”。 不难看出P(灰|B) = 1/3 , P(灰|A) = 2/4.

条件概率的计算公式如下所示：

	P(灰|B) = P(灰 and B) / P(B)

首先，用B桶中灰色石头的个数除以两个桶中总的石头数，得到P(灰 and B) = 1/7。其次，由于B桶中有3块石头，而总石头数为7，于是P(B)就等于 3/7. 于是有P(灰|B) = P(灰 and B) / P(B) = (1/7) / (3/7) = 1/3。

**贝叶斯准则**：如何交换条件概率的条件与结果，即如果已经P(x|c),要求P(c|x),那么可以使用下面的计算方法:

$$p(c|x) = \frac{p(x|c)p(c)}{p(x)}$$

# 3 使用条件概率来分类

在第1节提到了贝叶斯决策理论要求计算两个概率p1(x, y) 和p2(x, y):

- 如果p1(x, y) > p2(x, y) , 那么类别为1。
- 如果p2(x, y) > p1(x, y) , 那么类别为2.

但这两个准则并不是贝叶斯决策理论的所有内容。使用p1( )与 p2( )只是为了简化描述，而真正需要计算和比较的是$p(c_1|x, y)$和$p(c_2|x, y)$。这些符号所代表的具体意义是：给定某个由x,y表示的数据点，那么该数据点来自类别$c_1$或$c_2$的概率分别是多少？注意这些概率与之前给出的概率$p(x,y|c_1)$并不一样，不过可以使用贝叶斯准则来交换概率中的条件与结果。

$$p(c_i|x,y) = \frac{p(x,y|c_i)p(c_i)}{p(x,y)}$$

使用这些定义，可以定义贝叶斯分类准则为：

- 如果$p(c_1|x, y) > p(c_2|x, y)$, 那么类别为1。
- 如果$p(c_2|x, y) > p(c_1|x, y)$ , 那么类别为2.

使用贝叶斯准则，可以通过已知的三个概率值来计算未知的概率值。

# 4 使用朴素贝叶斯进行文档分类



